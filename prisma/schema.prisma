// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// 用户表
model User {
  id           Int            @id @default(autoincrement())
  name         String
  email        String         @unique
  // 登陆表
  Authenticate Authenticate[]
  // 签到表
  UserSign     UserSign[]
}

// 登陆表
model Authenticate {
  id       Int    @id @default(autoincrement())
  userId   Int
  userInfo User   @relation(fields: [userId], references: [id])
  username String
  password String

  @@unique(fields: [username, password], name: "login")
}

// 签到表 ----------- start

model UserSign {
  id          Int           @id @default(autoincrement())
  // 连续签到次数
  seriesDays  Int
  showSign    Boolean       @default(false)
  User        User?         @relation(fields: [userId], references: [id])
  userId      Int?          @unique
  UserSignLog UserSignLog[]
  SignConfig  SignConfig[]
}

model UserSignLog {
  id         Int       @id @default(autoincrement())
  userID     Int
  UserSign   UserSign? @relation(fields: [userSignId], references: [id])
  userSignId Int?
  // 签到奖励备注
  signReward String
  // 签到时间
  signTime   DateTime  @updatedAt
  // 签到类型 1=签到 2=补签
  signType   Int       @default(1)
  createTime DateTime  @default(now())
}

model SignConfig {
  id         Int       @id @default(autoincrement())
  // 签到天数
  signDay    Int       @default(1)
  // 明细种类 1 抽奖箱 2 货币 3...
  category   Int       @default(1)
  // 奖励数量
  number     Int       @default(1)
  // 备注
  mark       String
  // 次数
  isSet      Int       @default(1)
  UserSign   UserSign? @relation(fields: [userSignId], references: [id])
  userSignId Int?
  userId     Int
}

// 签到表 ----------- end
